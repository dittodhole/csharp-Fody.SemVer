<?xml version="1.0" encoding="utf-8"?>
<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <UsingTask TaskName="GetVersion" AssemblyFile="$(SemVerAssemblyFile)" />
  <Target Name="GetVersion" BeforeTargets="CoreCompile;GetAssemblyVersion;GenerateNuspec;_GenerateRestoreProjectSpec;_GetOutputItemsFromPack;EnsureWixToolsetInstalled" Condition="'$(SemVerStampActive)' == 'true'">
    <GetVersion BreakingChangeFormat="$(BreakingChangeFormat)" FeatureFormat="$(FeatureFormat)" PatchFormat="$(PatchFormat)" BaseRevision="$(BaseRevision)" BaseVersion="$(BaseVersion)" RepositoryPath="$(RepositoryPath)">
      <Output TaskParameter="PatchedVersion" PropertyName="SemVerStamp_Version" />
    </GetVersion>
    <PropertyGroup Condition=" '$(SemVerStampActive)' == 'true' ">
      <Version>$(SemVerStamp_Version)</Version>
      <VersionPrefix>$(SemVerStamp_Version)</VersionPrefix>
      <VersionSuffix></VersionSuffix>
      <PackageVersion>$(SemVerStamp_Version)</PackageVersion>
      <InformationalVersion Condition="'$(InformationalVersion)' == ''">$(SemVerStamp_Version)</InformationalVersion>
      <AssemblyVersion Condition="'$(AssemblyVersion)' == ''">$(SemVerStamp_Version)</AssemblyVersion>
      <FileVersion Condition="'$(FileVersion)' == ''">$(SemVerStamp_Version)</FileVersion>
    </PropertyGroup>
    <PropertyGroup Condition="'$(WixTargetsImported)' == 'true' And '$(GenerateGitVersionWixDefines)' == 'true'">
      <DefineConstants Condition="'$(SemVerStamp_Version)' != ''">SemVerStamp_Version=$(SemVerStamp_Version);$(DefineConstants)</DefineConstants>
    </PropertyGroup>
  </Target>
</Project>
